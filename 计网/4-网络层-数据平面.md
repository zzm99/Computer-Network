# 网络层-数据平面

1. 网络层分解为两个相互作用的部分：
   1. 数据平面：网络层中每台路由器的功能，该数据平面功能决定到达路由器输入链路之一的数据报如何转发到该路由器的输出链路之一。
   2. 控制平面：网络范围的逻辑，控制数据报沿着从源主机到目的主机的端到端路径中路由器之间的路由方式。
2. 网络层：将分组从一台发送主机移动到一台接收主机，
   1. 转发：数据平面中实现的唯一功能。通常硬件实现。
   2. 路由选择：路由选择在网络层的控制平面中实现。通常软件实现。
3. 某些分组交换机称为链路层交换机，基于链路层帧中的字段值做出转发决定，这些交换机因此被称为链路层设备。其他分组交换机称为路由器，基于网络层数据报中的首部字段值做出转发决定。路由器因此是网络层设别。
4. 输入端口处理：线路端接——》数据链路处理（协议，拆封）——》查找，转发，排队——》交换结构
5. 三种交换技术：内存、总线、纵横式（开关矩阵）。
6. 输出端口处理：交换结构——》排队（缓存管理）——》数据链路处理（协议，封装）——》线路端接
7. 输入排队或输出排队的分组调度：FIFO（FCFS）、优先权排队、循环和加权公平排队。
8. IPv4数据报中的关键字段如下：
   1. 版本号。规定了数据报的IP协议版本。
   2. 首部长度。因为一个IPv4数据报可包含一些可变数量的选项，故需要用这4比特来确定IP数据报中载荷实际开始的地方。大多数IP数据报不包含选项，所以一般的IP数据报具有20字节的首部。
   3. 服务类型。提供特定等级的服务是一个由网络管理员对路由器确定和配置的策略问题。
   4. 数据报长度。
   5. 标识、标志、片偏移。与IP分片有关。
   6. 寿命。用来确保数据报不会永远在网络中循环。每当一台路由器处理数据报时，该字段的值减1，若TTL字段减为0，则该数据报必须丢弃。
   7. 协议。该字段值指示了IP数据报的数据部分应交给哪个特定的运输层协议。
   8. 首部校验和。帮助路由器检测收到的IP数据报中的比特错误。
   9. 源和目的IP地址。
   10. 选项。选项字段允许IP首部被扩展。
   11. 数据（有效载荷）。在大多数情况下，IP数据报中的数据字段包含要交付给目的地的运输层报文段（TCP或UDP）。然而，该数据字段也可承载其他类型的数据，如ICMP报文。
9.  为了确定子网，分开主机和路由器的每个接口，产生几个隔离的网络岛，使用接口端接这些隔离的网络的端点。这些隔离的网络中的每一个都叫作一个子网。
10. IP广播地址255.255.255.255，当一台主机发出一个目的地址为255.255.255.255的数据报时，该报文会交付给同一个网络中的所有主机。
11. IPv6数据报中的关键字段如下：
    1.  版本。
    2.  流量类型。
    3.  流标签。标识一条数据报的流，能够对一条流中的某些数据报给出优先级，或者它能够用来对来自某些应用的数据报给出更高的优先级，以优于来自其他应用的数据报。
    4.  有效载荷长度。
    5.  下一个首部。标识数据报中的内容需要交付给哪个协议（如TCP或UDP）
    6.  跳限制。转发数据报的每台路由器将对该字段的内容减1.如果跳限制计数达到0，则该数据报将被丢弃。
    7.  源地址和目的地址。
    8.  数据。
12. IPv6中取消了的IPv4的字段为：分片/重新组装、首部校验和、选项。